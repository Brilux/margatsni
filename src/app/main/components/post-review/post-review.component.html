<mat-spinner class="spinner" *ngIf="spinner"></mat-spinner>

<div class="post-container" *ngIf="!spinner">
  <mat-card>
    <mat-card-header class="post-owner-container">
      <img mat-card-avatar class="post-owner-avatar" [src]="postUserImage || 'assets/images/default-avatar.png'"
           alt="userAvatar">
      <p class="post-owner-title" mat-card-title
         [routerLink]="[authorizedUser == postOwner ? '/user-profile/' : '/profile/' , postOwner ]">{{postOwner}}</p>
    </mat-card-header>

    <img mat-card-image src="{{postImage}}" alt="postImage">

    <mat-card-actions class="likes-container">
      <img class="like-icon" src='../../../../assets/images/like-false.png' *ngIf="!postLiked"
           (click)="likePost(likeResourceTypePost, postId)" alt="like-false">
      <img class="like-icon" src='../../../../assets/images/like-true.png' *ngIf="postLiked"
           (click)="dislike(likeResourceTypePost, postId)" alt="like-true">
      <p class="post-likes">{{postLikedCount}} likes</p>
    </mat-card-actions>

    <mat-card-content class="post-info-container" *ngIf="postDescription">
      <p class="post-owner">{{postOwner}}</p>
      <p class="post-description">{{postDescription}}</p>
    </mat-card-content>

    <mat-divider style="position: initial"></mat-divider>

    <div class="load-more-comments-container">
      <button class="load-more-comments-icon" mat-icon-button *ngIf="loadButton"
              (click)="getComments(postId, pageToLoad)">
        <mat-icon>add_circle_outline</mat-icon>
      </button>
    </div>

    <div class="post-comments" *ngFor="let comment of comments">
      <div class="post-comments-info-container">
        <p class="comment-owner"
           [routerLink]="[authorizedUser == comment.user.username ? '/user-profile/' : '/profile/' , comment.user.username ]">{{comment.user.username}}</p>
        <p class="comment-body" *ngIf="!comment.toggleForEdit">{{comment.body}}</p>

        <div *ngIf="comment.toggleForEdit">
          <mat-form-field class="edit-comment">
            <label>
              <input matInput type="text" [formControl]="inputCommentEdit" value="{{comment.body}}">
            </label>
          </mat-form-field>
          <button mat-stroked-button (click)="editComment(postId, comment.id, comment)">Edit</button>
        </div>
      </div>

      <div style="display: flex">
        <button class="update-comment-icon" mat-icon-button *ngIf="authorizedUser === comment.user.username"
                (click)="openEditComment(comment.id)">
          <mat-icon>edit</mat-icon>
        </button>

        <div class="comment-likes-container">
          <img class="like-comment-icon" src='../../../../assets/images/like-false.png' *ngIf="!comment.liked"
               (click)="likeComment(likeResourceTypeComment, comment.id)" alt="like-false">
          <img class="like-comment-icon" src='../../../../assets/images/like-true.png' *ngIf="comment.liked"
               (click)="dislikeComment(likeResourceTypeComment, comment.id)" alt="like-true">
          <span class="post-likes">{{comment.likes_count}} likes</span>
        </div>

        <button class="delete-comment-icon" mat-icon-button *ngIf="authorizedUser === comment.user.username"
                (click)="deleteComment(postId, comment.id, comment)">
          <mat-icon>clear</mat-icon>
        </button>
      </div>
    </div>

    <form (ngSubmit)="addComment(postId)">
      <mat-form-field style="display: block">
        <label>
          <input matInput type="text" [formControl]="addCommentForm" placeholder="Add a comment">
        </label>
      </mat-form-field>
    </form>

  </mat-card>
</div>
